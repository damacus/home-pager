# yaml-language-server: $schema=https://raw.githubusercontent.com/bjw-s-labs/helm-charts/app-template-4.5.0/charts/other/app-template/values.schema.json

app-template:
  defaultPodOptions:
    automountServiceAccountToken: false
    securityContext:
      runAsUser: 65534
      runAsGroup: 65534
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault

  controllers:
    main:
      strategy: RollingUpdate
      replicas: 1

      containers:
        main:
          image:
            repository: ghcr.io/damacus/home-pager
            tag: latest
            pullPolicy: IfNotPresent

          env:
            PORT: "8080"

          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
            capabilities:
              drop:
                - ALL

          resources:
            requests:
              cpu: 10m
              memory: 16Mi
            limits:
              memory: 32Mi

          probes:
            liveness:
              enabled: true
              custom: true
              spec:
                httpGet:
                  path: /
                  port: 8080
                initialDelaySeconds: 5
                periodSeconds: 10
            readiness:
              enabled: true
              custom: true
              spec:
                httpGet:
                  path: /
                  port: 8080
                initialDelaySeconds: 5
                periodSeconds: 10

  service:
    main:
      controller: main
      ports:
        http:
          port: 8080

  ingress:
    main:
      enabled: false
      className: ""
      hosts:
        - host: home-pager.local
          paths:
            - path: /
              pathType: Prefix
              service:
                identifier: main
                port: http
